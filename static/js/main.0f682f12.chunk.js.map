{"version":3,"sources":["components/Header.jsx","components/Video.jsx","components/VideoBar.jsx","components/App.jsx","index.js","../node_modules/peerjs/dist sync"],"names":["Header","props","state","video","audio","this","setState","className","href","onClick","onVideoToggle","userId","toggleVideoCss","onAudioToggle","toggleAudioCss","Component","Video","srcObject","media","width","height","muted","children","autoPlay","ref","React","defaultProps","VideoBar","peersStream","map","peer","stream","myPeer","Peer","socket","io","peers","App","handleVideoToggle","bind","handleAudioToggle","on","id","navigator","mediaDevices","getUserMedia","then","addUserIdAndStream","addVideoStream","connectToNewUser","call","answer","userVideoStream","peersModified","filter","emit","roomId","close","flag","getVideoTracks","enabled","getAudioTracks","forEach","push","Fragment","uuidV4","require","v4","Room","useParams","ReactDOM","render","exact","path","to","document","getElementById","webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports"],"mappings":"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","file":"static/js/main.0f682f12.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport \"../css/Header.css\";\r\n\r\nclass Header extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      video: false,\r\n      audio: false,\r\n    };\r\n  }\r\n  toggleAudioCss() {\r\n    let audio = this.state.audio;\r\n    this.setState({ audio: !audio });\r\n  }\r\n  toggleVideoCss() {\r\n    let video = this.state.video;\r\n    this.setState({ video: !video });\r\n  }\r\n  render() {\r\n    return (\r\n      <div className=\"header\">\r\n        <span href=\"#\" className=\"logo\">\r\n          PEER CODER\r\n        </span>\r\n        <div className=\"header-right\">\r\n          <button\r\n            className={this.state.video ? \"buttonOn\" : \"buttonOff\"}\r\n            onClick={() => {\r\n              this.props.onVideoToggle(this.props.userId);\r\n              this.toggleVideoCss();\r\n            }}\r\n          >\r\n            <i className=\"fa fa-video-camera\"></i>\r\n          </button>\r\n          <button\r\n            className={this.state.audio ? \"buttonOn\" : \"buttonOff\"}\r\n            onClick={() => {\r\n              this.props.onAudioToggle(this.props.userId);\r\n              this.toggleAudioCss();\r\n            }}\r\n          >\r\n            <i className=\"fa fa-microphone\"></i>\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Header;\r\n","import PropTypes from \"prop-types\";\r\nimport React from \"react\";\r\nimport \"../css/Video.css\";\r\n\r\nclass Video extends React.Component {\r\n  componentDidMount() {\r\n    this.video.srcObject = this.props.media;\r\n  }\r\n\r\n  shouldComponentUpdate(props) {\r\n    return this.props.media !== props.media;\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.video.srcObject = this.props.media;\r\n  }\r\n\r\n  render() {\r\n    const { width, height, muted, children } = this.props;\r\n\r\n    return (\r\n      <video\r\n        height={height}\r\n        width={width}\r\n        muted={muted}\r\n        autoPlay\r\n        ref={(video) => {\r\n          this.video = video;\r\n        }}\r\n      >\r\n        {children}\r\n      </video>\r\n    );\r\n  }\r\n}\r\n\r\nVideo.defaultProps = {\r\n  children: null,\r\n  height: 110,\r\n  width: 160,\r\n  muted: false,\r\n  media: null,\r\n};\r\n\r\nVideo.propTypes = {\r\n  children: PropTypes.element,\r\n  media: PropTypes.shape({\r\n    active: PropTypes.bool,\r\n    ended: PropTypes.bool,\r\n    id: PropTypes.string,\r\n  }),\r\n  height: PropTypes.number,\r\n  width: PropTypes.number,\r\n  muted: PropTypes.bool,\r\n};\r\n\r\nexport default Video;\r\n","import React, { Component } from \"react\";\r\nimport Video from \"./Video\";\r\nimport \"../css/VideoBar.css\";\r\n\r\nclass VideoBar extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"scrollmenu\">\r\n        {this.props.peersStream.map((peer) => {\r\n          return (\r\n            <Video\r\n              key={peer.userId}\r\n              media={peer.stream}\r\n              height={110}\r\n              width={160}\r\n              muted={this.props.userId === peer.userId ? true : false}\r\n            ></Video>\r\n          );\r\n        })}\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport default VideoBar;\r\n","import React, { Component } from \"react\";\r\nimport Header from \"./Header\";\r\nimport VideoBar from \"./VideoBar\";\r\nimport io from \"socket.io-client\";\r\nimport Peer from \"peerjs\";\r\nconst myPeer = new Peer();\r\nconst socket = io(\"https://fast-castle-08546.herokuapp.com/\");\r\nconst peers = {};\r\n\r\nclass App extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      userId: \"\",\r\n      stream: {},\r\n      peers: [],\r\n    };\r\n    this.handleVideoToggle = this.handleVideoToggle.bind(this);\r\n    this.handleAudioToggle = this.handleAudioToggle.bind(this);\r\n  }\r\n  componentDidMount() {\r\n    myPeer.on(\"open\", (id) => {\r\n      navigator.mediaDevices\r\n        .getUserMedia({\r\n          video: true,\r\n          audio: true,\r\n        })\r\n        .then((stream) => {\r\n          this.addUserIdAndStream(id, stream);\r\n          this.addVideoStream(id, stream, false);\r\n          socket.on(\"user-connected\", (userId) => {\r\n            this.connectToNewUser(userId, stream);\r\n          });\r\n          myPeer.on(\"call\", (call) => {\r\n            call.answer(stream);\r\n            call.on(\"stream\", (userVideoStream) => {\r\n              this.addVideoStream(call.peer, userVideoStream, false);\r\n            });\r\n            call.on(\"close\", () => {\r\n              const peers = this.state.peers;\r\n              var peersModified = peers.filter((peer) => {\r\n                return peer.userId !== call.peer;\r\n              });\r\n              this.setState({ peers: peersModified });\r\n            });\r\n            peers[call.peer] = call;\r\n          });\r\n          socket.emit(\"join-room\", this.props.roomId, id);\r\n        });\r\n    });\r\n    socket.on(\"user-disconnected\", (userId) => {\r\n      if (peers[userId]) peers[userId].close();\r\n    });\r\n  }\r\n  connectToNewUser(userId, stream) {\r\n    const call = myPeer.call(userId, stream);\r\n    call.on(\"stream\", (userVideoStream) => {\r\n      this.addVideoStream(userId, userVideoStream, false);\r\n    });\r\n    call.on(\"close\", () => {\r\n      const peers = this.state.peers;\r\n      var peersModified = peers.filter((peer) => {\r\n        return peer.userId !== userId;\r\n      });\r\n      this.setState({ peers: peersModified });\r\n    });\r\n    peers[userId] = call;\r\n  }\r\n\r\n  addVideoStream(userId, stream, flag) {\r\n    if (userId === this.state.userId) {\r\n      stream.getVideoTracks()[0].enabled = false;\r\n      stream.getAudioTracks()[0].enabled = false;\r\n    }\r\n    const peers = this.state.peers;\r\n    peers.forEach((peer) => {\r\n      if (peer.userId === userId) {\r\n        peer.stream = stream;\r\n        flag = true;\r\n      }\r\n    });\r\n    if (!flag) peers.push({ userId: userId, stream: stream });\r\n    this.setState({ peers: peers });\r\n  }\r\n\r\n  addUserIdAndStream(userId, stream) {\r\n    this.setState({ userId: userId, stream: stream });\r\n  }\r\n\r\n  handleVideoToggle(userId) {\r\n    this.state.peers.forEach((peer) => {\r\n      if (peer.userId === userId) {\r\n        const enabled = peer.stream.getVideoTracks()[0].enabled;\r\n        peer.stream.getVideoTracks()[0].enabled = !enabled;\r\n      }\r\n    });\r\n  }\r\n\r\n  handleAudioToggle(userId) {\r\n    this.state.peers.forEach((peer) => {\r\n      if (peer.userId === userId) {\r\n        const enabled = peer.stream.getAudioTracks()[0].enabled;\r\n        peer.stream.getAudioTracks()[0].enabled = !enabled;\r\n      }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <Header\r\n          userId={this.state.userId}\r\n          stream={this.state.stream}\r\n          onVideoToggle={this.handleVideoToggle}\r\n          onAudioToggle={this.handleAudioToggle}\r\n        />\r\n        <VideoBar peersStream={this.state.peers} userId={this.state.userId} />\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\nexport default App;\r\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./components/App\";\nimport {\n  HashRouter as Router,\n  Route,\n  useParams,\n  Redirect,\n} from \"react-router-dom\";\nconst { v4: uuidV4 } = require(\"uuid\");\nReactDOM.render(\n  <Router>\n    <Route exact path=\"/\">\n      <Redirect to={\"/\" + uuidV4()} />\n    </Route>\n    <Route path=\"/:roomId\" children={<Room />} />\n  </Router>,\n  document.getElementById(\"root\")\n);\n\nfunction Room() {\n  let { roomId } = useParams();\n  return <App roomId={roomId} />;\n}\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 96;"],"sourceRoot":""}