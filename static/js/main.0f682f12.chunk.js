(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{105:function(e,t,n){"use strict";n.r(t);var o=n(0),s=n.n(o),a=n(50),r=n.n(a),i=n(11),c=n(12),d=n(21),u=n(14),l=n(13),h=(n(59),n(1)),f=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).state={video:!1,audio:!1},o}return Object(c.a)(n,[{key:"toggleAudioCss",value:function(){var e=this.state.audio;this.setState({audio:!e})}},{key:"toggleVideoCss",value:function(){var e=this.state.video;this.setState({video:!e})}},{key:"render",value:function(){var e=this;return Object(h.jsxs)("div",{className:"header",children:[Object(h.jsx)("span",{href:"#",className:"logo",children:"PEER CODER"}),Object(h.jsxs)("div",{className:"header-right",children:[Object(h.jsx)("button",{className:this.state.video?"buttonOn":"buttonOff",onClick:function(){e.props.onVideoToggle(e.props.userId),e.toggleVideoCss()},children:Object(h.jsx)("i",{className:"fa fa-video-camera"})}),Object(h.jsx)("button",{className:this.state.audio?"buttonOn":"buttonOff",onClick:function(){e.props.onAudioToggle(e.props.userId),e.toggleAudioCss()},children:Object(h.jsx)("i",{className:"fa fa-microphone"})})]})]})}}]),n}(o.Component),p=(n(61),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"componentDidMount",value:function(){this.video.srcObject=this.props.media}},{key:"shouldComponentUpdate",value:function(e){return this.props.media!==e.media}},{key:"componentDidUpdate",value:function(){this.video.srcObject=this.props.media}},{key:"render",value:function(){var e=this,t=this.props,n=t.width,o=t.height,s=t.muted,a=t.children;return Object(h.jsx)("video",{height:o,width:n,muted:s,autoPlay:!0,ref:function(t){e.video=t},children:a})}}]),n}(s.a.Component));p.defaultProps={children:null,height:110,width:160,muted:!1,media:null};var m=p,j=(n(62),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(c.a)(n,[{key:"render",value:function(){var e=this;return Object(h.jsx)("div",{className:"scrollmenu",children:this.props.peersStream.map((function(t){return Object(h.jsx)(m,{media:t.stream,height:110,width:160,muted:e.props.userId===t.userId},t.userId)}))})}}]),n}(o.Component)),b=n(51),v=n.n(b),g=n(52),O=new(n.n(g).a),k=v()("https://fast-castle-08546.herokuapp.com/"),I={},x=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(e){var o;return Object(i.a)(this,n),(o=t.call(this,e)).state={userId:"",stream:{},peers:[]},o.handleVideoToggle=o.handleVideoToggle.bind(Object(d.a)(o)),o.handleAudioToggle=o.handleAudioToggle.bind(Object(d.a)(o)),o}return Object(c.a)(n,[{key:"componentDidMount",value:function(){var e=this;O.on("open",(function(t){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(n){e.addUserIdAndStream(t,n),e.addVideoStream(t,n,!1),k.on("user-connected",(function(t){e.connectToNewUser(t,n)})),O.on("call",(function(t){t.answer(n),t.on("stream",(function(n){e.addVideoStream(t.peer,n,!1)})),t.on("close",(function(){var n=e.state.peers.filter((function(e){return e.userId!==t.peer}));e.setState({peers:n})})),I[t.peer]=t})),k.emit("join-room",e.props.roomId,t)}))})),k.on("user-disconnected",(function(e){I[e]&&I[e].close()}))}},{key:"connectToNewUser",value:function(e,t){var n=this,o=O.call(e,t);o.on("stream",(function(t){n.addVideoStream(e,t,!1)})),o.on("close",(function(){var t=n.state.peers.filter((function(t){return t.userId!==e}));n.setState({peers:t})})),I[e]=o}},{key:"addVideoStream",value:function(e,t,n){e===this.state.userId&&(t.getVideoTracks()[0].enabled=!1,t.getAudioTracks()[0].enabled=!1);var o=this.state.peers;o.forEach((function(o){o.userId===e&&(o.stream=t,n=!0)})),n||o.push({userId:e,stream:t}),this.setState({peers:o})}},{key:"addUserIdAndStream",value:function(e,t){this.setState({userId:e,stream:t})}},{key:"handleVideoToggle",value:function(e){this.state.peers.forEach((function(t){if(t.userId===e){var n=t.stream.getVideoTracks()[0].enabled;t.stream.getVideoTracks()[0].enabled=!n}}))}},{key:"handleAudioToggle",value:function(e){this.state.peers.forEach((function(t){if(t.userId===e){var n=t.stream.getAudioTracks()[0].enabled;t.stream.getAudioTracks()[0].enabled=!n}}))}},{key:"render",value:function(){return Object(h.jsxs)(s.a.Fragment,{children:[Object(h.jsx)(f,{userId:this.state.userId,stream:this.state.stream,onVideoToggle:this.handleVideoToggle,onAudioToggle:this.handleAudioToggle}),Object(h.jsx)(j,{peersStream:this.state.peers,userId:this.state.userId})]})}}]),n}(o.Component),T=n(53),y=n(2),V=n(104).v4;function S(){var e=Object(y.f)().roomId;return Object(h.jsx)(x,{roomId:e})}r.a.render(Object(h.jsxs)(T.a,{children:[Object(h.jsx)(y.b,{exact:!0,path:"/",children:Object(h.jsx)(y.a,{to:"/"+V()})}),Object(h.jsx)(y.b,{path:"/:roomId",children:Object(h.jsx)(S,{})})]}),document.getElementById("root"))},59:function(e,t,n){},61:function(e,t,n){},62:function(e,t,n){},96:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=96}},[[105,1,2]]]);
//# sourceMappingURL=main.0f682f12.chunk.js.map